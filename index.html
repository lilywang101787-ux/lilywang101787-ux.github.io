<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lily genius</title>
    <!-- 优先用这个备用 SDK 链接，兼容所有环境 -->
    <script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-100-M/coze/sdk/chat/v1/index.js"></script>
    <style>
        #coze-chat-container { width: 100%; height: 600px; border: 1px solid #eee; border-radius: 8px; padding: 10px; overflow-y: auto; margin: 20px auto; max-width: 800px; }
        .user-msg { background: #e8f4f8; padding: 8px 12px; border-radius: 8px; margin: 8px 0; text-align: right; }
        .bot-msg { background: #f5f5f5; padding: 8px 12px; border-radius: 8px; margin: 8px 0; text-align: left; }
        #input-area { display: flex; gap: 10px; max-width: 800px; margin: 0 auto; }
        #msg-input { flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        #send-btn { padding: 8px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>
    <div id="coze-chat-container"></div>
    <div id="input-area">
        <input type="text" id="msg-input" placeholder="输入测试内容">
        <button id="send-btn">发送</button>
    </div>

    <script>
        // 先检查 CozeChat 是否加载成功
        if (typeof CozeChat === 'undefined') {
            alert("SDK加载失败！请检查网络或更换SDK链接");
            console.error("CozeChat 未定义，SDK加载失败");
        } else {
        // 替换成你自己的参数
        const PAT = "pat_1OM37bwhYsobDPA8pciu521q4R2LkAR29nt7U7A8PpwBGrsnXWElSkLHrpOFnwdM"; // 格式：pat_xxxxxxxxxxxxxxxxxxxx
        const BOT_ID = "7610693462039707674"; // 格式：1234567890abcdef

            let cozeChat = null;
            window.onload = function() {
                try {
                    cozeChat = new CozeChat({
                        container: document.getElementById('coze-chat-container'),
                        apiKey: PAT,
                        botId: BOT_ID,
                        userId: "test-user-001",
                        language: "zh-CN",
                        showThinking: false,
                        showReasoning: false
                    });
                    cozeChat.mount();
                    alert("SDK初始化成功！"); // 测试提示

                    // 绑定发送事件
                    const sendBtn = document.getElementById('send-btn');
                    const msgInput = document.getElementById('msg-input');
                    sendBtn.addEventListener('click', () => {
                        const msg = msgInput.value.trim();
                        if (!msg) return;
                        document.getElementById('coze-chat-container').innerHTML += `<div class="user-msg">${msg}</div>`;
                        msgInput.value = '';
                        cozeChat.sendMessage(msg).then(res => {
                            document.getElementById('coze-chat-container').innerHTML += `<div class="bot-msg">${res.content || '暂无回复'}</div>`;
                        });
                    });
                } catch (err) {
                    alert("初始化失败：" + err.message);
                }
            };
        }
    </script>
</body>
</html>